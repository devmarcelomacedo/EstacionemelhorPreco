<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gest√£o de Estacionamento</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --bg: #0f111a;
            --card: #1a1d29;
            --pink: #ff2d55;
            --input: #252936;
        }
        body { background: var(--bg); color: white; font-family: sans-serif; margin: 0; padding: 20px; padding-bottom: 80px; }
        
        /* Dashboard */
        .dashboard { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin-bottom: 20px; }
        .card { background: var(--card); padding: 15px; border-radius: 10px; border-left: 4px solid var(--pink); }
        .card span { color: #a0a0a0; font-size: 0.8rem; }
        .card strong { font-size: 1.2rem; display: block; margin-top: 5px; }
        .pink { color: var(--pink); }

        /* Tabs */
        .tabs { display: flex; justify-content: space-around; margin-bottom: 20px; border-bottom: 1px solid #333; }
        .tab-btn { background: none; border: none; color: #a0a0a0; padding: 10px; cursor: pointer; font-size: 1rem; }
        .tab-btn.active { color: var(--pink); border-bottom: 2px solid var(--pink); }

        /* Form e Conte√∫do */
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .form-container { background: var(--card); padding: 20px; border-radius: 15px; }
        input, select { width: 100%; padding: 12px; background: var(--input); border: 1px solid #333; border-radius: 8px; color: white; margin: 8px 0; box-sizing: border-box; }
        .btn-confirmar { width: 100%; padding: 15px; background: var(--pink); border: none; border-radius: 10px; color: white; font-weight: bold; cursor: pointer; margin-top: 10px; }
        
        /* Itens de Sa√≠da */
        .veiculo-item { background: var(--input); padding: 15px; border-radius: 8px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #444; }
        
        /* Bot√µes de Relat√≥rio */
        .relatorio-actions { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .btn-rel { padding: 10px; border: none; border-radius: 5px; background: #333; color: white; cursor: pointer; font-size: 0.8rem; }
        .btn-rel:hover { background: var(--pink); }

        /* √çCONE FLUTUANTE (GITHUB PAGES) */
        .floating-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background-color: var(--pink);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            text-decoration: none;
            z-index: 1000;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>

    <h2>üöó Gest√£o de Estacionamento</h2>

    <div class="dashboard">
        <div class="card"><span>Vagas Livres</span><strong id="vagas-disponiveis">50</strong></div>
        <div class="card"><span>Ocupadas</span><strong id="vagas-ocupadas" class="pink">0</strong></div>
        <div class="card"><span>Total Caixa</span><strong id="faturamento" class="pink">R$ 0.00</strong></div>
    </div>

    <nav class="tabs">
        <button class="tab-btn active" onclick="openTab('tab-entrada', this)">Entrada</button>
        <button class="tab-btn" onclick="openTab('tab-saida', this)">P√°tio</button>
        <button class="tab-btn" onclick="openTab('tab-relatorios', this)">Relat√≥rios</button>
    </nav>

    <div id="tab-entrada" class="tab-content active">
        <div class="form-container">
            <h3>Novo Registro</h3>
            <form id="formEntrada">
                <input type="text" id="nome" placeholder="Nome do Condutor" required>
                <input type="text" id="whatsapp" placeholder="WhatsApp (Opcional)">
                <input type="email" id="email" placeholder="E-mail (Opcional)">
                <select id="tipo">
                    <option value="1.50">Moto (R$ 1.50)</option>
                    <option value="3.00">Carro (R$ 3.00)</option>
                    <option value="5.00">Caminhonete/SUV (R$ 5.00)</option>
                </select>
                <input type="text" id="placa" placeholder="Placa (Ex: ABC1234)" required>
                <input type="time" id="horaEntrada" required>
                <button type="submit" class="btn-confirmar">Confirmar Entrada</button>
            </form>
        </div>
    </div>

    <div id="tab-saida" class="tab-content">
        <div id="lista-patio"></div>
    </div>

    <div id="tab-relatorios" class="tab-content">
        <div class="form-container">
            <h3>Exportar Relat√≥rios (Excel)</h3>
            <div class="relatorio-actions">
                <button class="btn-rel" onclick="exportarExcel('diario')">Di√°rio</button>
                <button class="btn-rel" onclick="exportarExcel('semanal')">Semanal</button>
                <button class="btn-rel" onclick="exportarExcel('mensal')">Mensal</button>
            </div>
            <div id="res-relatorio">Selecione o per√≠odo acima para baixar o arquivo .csv</div>
        </div>
    </div>

    <a href="https://SEU-USUARIO.github.io/NOME-DO-PROJETO/" class="floating-btn" id="link-projeto">
        <i class="fas fa-qrcode"></i>
    </a>

    <script>
        let patio = JSON.parse(localStorage.getItem('patio')) || [];
        let historico = JSON.parse(localStorage.getItem('historico')) || [];
        let faturamento = parseFloat(localStorage.getItem('faturamento')) || 0;

        // Hora atual autom√°tica
        document.getElementById('horaEntrada').value = new Date().toLocaleTimeString('pt-BR', {hour: '2-digit', minute:'2-digit'});

        function salvar() {
            localStorage.setItem('patio', JSON.stringify(patio));
            localStorage.setItem('historico', JSON.stringify(historico));
            localStorage.setItem('faturamento', faturamento.toString());
            atualizarPainel();
        }

        function openTab(id, btn) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            btn.classList.add('active');
            if(id === 'tab-saida') renderPatio();
        }

        document.getElementById('formEntrada').onsubmit = function(e) {
            e.preventDefault();
            const veiculo = {
                id: Date.now(),
                nome: document.getElementById('nome').value,
                whatsapp: document.getElementById('whatsapp').value || "N√£o informado",
                email: document.getElementById('email').value || "N√£o informado",
                tipo: document.getElementById('tipo').options[document.getElementById('tipo').selectedIndex].text,
                valor: parseFloat(document.getElementById('tipo').value),
                placa: document.getElementById('placa').value.toUpperCase(),
                entrada: document.getElementById('horaEntrada').value,
                data: new Date().toLocaleDateString('pt-BR')
            };
            patio.push(veiculo);
            salvar();
            this.reset();
            alert("Ve√≠culo Registrado!");
        };

        function atualizarPainel() {
            document.getElementById('vagas-ocupadas').innerText = patio.length;
            document.getElementById('vagas-disponiveis').innerText = 50 - patio.length;
            document.getElementById('faturamento').innerText = `R$ ${faturamento.toFixed(2)}`;
        }

        function renderPatio() {
            const lista = document.getElementById('lista-patio');
            lista.innerHTML = patio.length === 0 ? "<p>P√°tio Vazio</p>" : "";
            patio.forEach((v, index) => {
                const item = document.createElement('div');
                item.className = 'veiculo-item';
                item.innerHTML = `
                    <div><strong>${v.placa}</strong><br><small>${v.tipo} - ${v.entrada}</small></div>
                    <button onclick="darSaida(${index})" class="btn-confirmar" style="width:80px; margin:0; padding:10px">Sa√≠da</button>
                `;
                lista.appendChild(item);
            });
        }

        function darSaida(index) {
            const v = patio[index];
            v.saida = new Date().toLocaleTimeString('pt-BR', {hour: '2-digit', minute:'2-digit'});
            faturamento += v.valor;
            historico.push(v);
            patio.splice(index, 1);
            salvar();
            renderPatio();
            
            // Envio Opcional WhatsApp (Link de comprovante)
            if(v.whatsapp !== "N√£o informado") {
                const msg = `COMPROVANTE: Placa ${v.placa}, Entrada ${v.entrada}, Sa√≠da ${v.saida}. Valor: R$ ${v.valor.toFixed(2)}`;
                window.open(`https://api.whatsapp.com/send?phone=55${v.whatsapp}&text=${encodeURIComponent(msg)}`);
            }
        }

        function exportarExcel(periodo) {
            if(historico.length === 0) return alert("Nenhum dado para exportar!");
            
            let csv = "Data,Nome,Placa,Tipo,Entrada,Saida,Valor\n";
            historico.forEach(v => {
                csv += `${v.data},${v.nome},${v.placa},${v.tipo},${v.entrada},${v.saida},${v.valor}\n`;
            });

            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement("a");
            const url = URL.createObjectURL(blob);
            link.setAttribute("href", url);
            link.setAttribute("download", `relatorio_${periodo}_estacionamento.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        atualizarPainel();
    </script>
</body>
</html>